\documentclass[reqno]{amsart}
 % reqno causes equations to be numbered on the right.
\setlength{\textheight}{43pc}
\setlength {\textwidth}{28pc}

\usepackage{amssymb, latexsym, amsmath, amsfonts, amscd}
\usepackage{lscape,color}
\usepackage{mathrsfs, hyperref}
\usepackage{verbatim}
\usepackage{showlabels}
\usepackage{appendix}
\usepackage{tikz}
\usetikzlibrary{quantikz}

% Theorem statements that will be italicized.
% Adding a * after \newtheorem will make it so that these aren't numbered.
\newtheorem{lemma}{Lemma}
\newtheorem{theorem}{Theorem}
\newtheorem{proposition}{Proposition}
\newtheorem{corollary}{Corollary}
%\newtheorem{remark}{Remark}

% Theorem statements that will not be italicized.
%\theoremstyle{definition}\newtheorem*{definition}{Definition}
%{\theoremstyle{definition}\newtheorem*{comment}{Comment}}
{\theoremstyle{definition}\newtheorem{remark}{Remark}}
%{\theoremstyle{definition}\newtheorem{example}{Example}}

% This makes it so that the lemmas are numbered 1.1, 1.2, etc., depending on which
% section they occur in.
\numberwithin{lemma}{section}
\numberwithin{proposition}{section}

% Some special commands
\newcommand{\dee}{\mathrm{d}}
\newcommand{\R}{\mathbf{R}}
\newcommand{\Q}{\mathbf{Q}}
%\newcommand{\C}{\mathbf{C}}
\newcommand{\T}{\mathbf{T}}
\newcommand{\Z}{\mathbf{Z}}
\newcommand{\N}{\mathbf{N}}
\newcommand{\F}{\tilde{\mathscr{F}}}
%\newcommand{\G}{\tilde{\mathscr{G}}}
\newcommand{\HH}{\tilde{\mathscr{H}}}
\newcommand{\dist}{\textnormal{dist}}
\newcommand{\sech}{\textnormal{sech}}
\newcommand{\p}{\partial}
\newcommand{\Qproj}{\mathscr{Q}}
\newcommand{\Pproj}{\mathscr{P}}
\newcommand{\supp}{\textnormal{supp }}
\newcommand{\tw}{\tilde{w}}
\newcommand{\tv}{\tilde{v}}
\newcommand{\la}{\langle}
\newcommand{\Span}{\textnormal{Span}}


\begin{document}

\begin{center}
    \textbf{Notes on Asymmetric Cloning}
\end{center}

\section{Asymmetric cloning machines}

In this section we develop the universal quantum cloning machine (UQCM) following the presentation in \cite{REZAKHANI2005278}. We restrict our attention to the $2$-dimensional case, i.e. to qubits.

\subsection{Universal Cloning Machines}
Here we consider a unitary transformation
\begin{equation*}
    \ket{i}_{A} \ket{O}_{B} \ket{\Sigma}_{X} \to \mu \ket{i}_{A} \ket{i}_{B} \ket{i}_{X} + \nu \sum_{j \neq i} \Big ( \ket{i}_{A} \ket{j}_{B} + \ket{j}_{A} \ket{i}_{B} \Big ) \ket{j}_{X}.
\end{equation*}
Here $A$ refers to the input qubit, $B$ is a blank qubit, and $X$ is an ancilla. The ancilla is initially in some fixed state, say $\ket{\Sigma}$. In particular, the unitary can be expressed in terms of the basis states $\ket{0}$ and $\ket{1}$:
\begin{equation}
	\label{UCM}
	\begin{aligned}
    \ket{0}_{A} \ket{O}_{B} \ket{\Sigma}_{X} &\to \mu \ket{0}_{A} \ket{0}_{B} \ket{0}_{X} + \nu \Big ( \ket{0}_{A} \ket{1}_{B} \ket{1}_{X} + \ket{1}_{A} \ket{0}_{B} \ket{1}_{X} \Big )\\
    \ket{1}_{A} \ket{O}_{B} \ket{\Sigma}_{X} &\to \mu \ket{1}_{A} \ket{1}_{B} \ket{1}_{X} + \nu \Big ( \ket{1}_{A} \ket{0}_{B} \ket{0}_{X} + \ket{0}_{A} \ket{1}_{B} \ket{0}_{X} \Big ).
    \end{aligned}
\end{equation}
We point out that the parameters, $\mu$ and $\nu$, can be taken to be real parameters (imaginary terms can be absorbed into the ancilla). We impose the following restrictions on the output of the cloner:
\begin{enumerate}
    \item the fidelity of the copies, $F = \langle \psi \vert \rho^{\text{(out)}} \vert \psi \rangle$ does not depend on the particular state which is being copied;
    \item the outputs are symmetric, meaning that $\rho_{A}^{\text{(out)}} = \rho_{B}^{\text{(out)}}$.
\end{enumerate}
These restrictions yield the following relations:
\begin{align*}
    \rho_{A}^{\text{(out)}} &= \eta \ket{\psi}_{A}\bra{\psi} + \frac{1 - \eta}{2} \mathbf{1}_{A}\\
    \rho_{B}^{\text{(out)}} &= \eta \ket{\psi}_{A} \bra{\psi} + \frac{1 - \eta}{2} \mathbf{1}_{B}\\
    \mu^{2} &= 2\mu \nu\\
    \mu^{2} &= \frac{2}{3}\\
    \nu^{2} &= \frac{1}{6}\\
    \eta &= \mu^{2} = \frac{2}{3}.
\end{align*}
Here $\mathbf{1}_{A}$ is the identity operator on the Hilbert space $\mathcal{H}_{A}$ and $\eta = 2F - 1$ is called the shrinking factor (recall that $F$ is the fidelity as defined above). In the case of qubits we see that the fidelity is $F = 5/6$.

\begin{proof}[Detailed Calculations]
	For brevity we will write $\ket{ijk}$ in place of $\ket{i}_{A} \ket{j}_{B} \ket{k}_{X}$.
	
	First, since we require the output to be normalized, we find that
	\begin{equation*}
		\mu^{2} + 2 \nu^{2} = 1.
	\end{equation*}
	
	Consider input $\ket{\psi}_{A} = \alpha_{0} \ket{0} + \alpha_{1} \ket{1}$ with $\vert \alpha_{0} \vert^{2} + \vert \alpha_{1} \vert^{2} = 1$. The output of the machine described by \eqref{UCM} is
	\begin{align*}
		\mu \alpha_{0} \ket{000} + \alpha_{0} \nu \Big (\ket{011} + \ket{101} \Big ) + \mu \alpha_{1} \ket{111} + \nu \alpha_{1} \Big ( \ket{100} + \ket{010} \Big ).
	\end{align*}
	The associated density operator is
	\begin{align*}
		\rho &= \left ( \mu \alpha_{0} \ket{000} + \alpha_{0} \nu \Big (\ket{011} + \ket{101} \Big ) + \mu \alpha_{1} \ket{111} + \nu \alpha_{1} \Big ( \ket{100} + \ket{010} \Big )\right )\\
		& \quad \left ( \mu \alpha_{0}^{*} \bra{000} + \alpha_{0}^{*} \nu \Big (\bra{011} + \bra{101} \Big ) + \mu \alpha_{1}^{*} \bra{111} + \nu \alpha_{1}^{*} \Big ( \bra{100} + \bra{010} \Big )\right )\\
		&= \mu^{2} \vert \alpha_{0} \vert^{2} \ket{000} \bra{000} + \mu \nu \vert \alpha_{0} \vert^{2} \Big ( \ket{000} \bra{011} + \ket{000} \bra{101} \Big )\\
		&\quad + \mu^{2} \alpha_{0} \alpha_{1}^{*} \ket{000} \bra{111} + \mu \nu \alpha_{0} \alpha_{1}^{*} \Big ( \ket{000} \bra{100} + \ket{000} \bra{010} \Big ) + \ldots.
	\end{align*}
	To determine the density operator $\rho_{A}^{\textnormal{(out)}}$ we now trace out the qubits from $B$ and $X$:
	\begin{align*}
		\rho_{A}^{\textnormal{(out)}} = &\Big ( \vert \alpha_{0} \vert^{2}\mu^{2} + \vert \alpha_{0} \vert^{2} \nu^{2} + \vert \alpha_{1}^{2} \nu^{2} \Big ) \ket{0} \bra{0}\\
		+ &2 \mu \nu \alpha_{0} \alpha_{1}^{*} \mu \nu \ket{0} \bra{1}
		+ 2 \mu \nu \alpha_{0}^{*} \alpha_{1} \ket{1} \bra{0}\\
		+ &\Big ( \vert \alpha_{1} \vert^{2} \mu^{2} + \vert \alpha_{0} \vert^{2} \nu^{2} + \alpha_{1} \vert^{2} \nu^{2} \Big ) \ket{1} \bra{1}
	\end{align*}
	Recalling that $\vert \alpha_{0} \vert^{2} + \vert \alpha_{1} \vert^{2} = 1$, the $\ket{0}\bra{0}$ and $\ket{1}\bra{1}$ entries simplify and we are left with
	\begin{align*}
		\rho_{A}^{\textnormal{(out)}} &= \Big ( \mu^{2} \vert \alpha_{0} \vert^{2} \ket{0}\bra{0} + 2\mu \nu \alpha_{0} \alpha_{1}^{*} \ket{0}\bra{1} + 2\mu \nu \alpha_{0}^{*} \alpha_{1} \ket{1}\bra{0} + \mu^{2} \vert \alpha_{1} \vert^{2} \Big )\\
		&\quad  + \nu^{2} \Big ( \ket{0}\bra{0} + \ket{1}\bra{1} \Big )
	\end{align*}
	Since $\mu^{2} + 2\nu^{2} = 1$ we have $\nu^{2} = (1-\mu^{2})/2$. An analogous calculation yields
	\begin{equation*}
		\ket{\psi}_{A} \bra{\psi} = \vert \alpha_{0} \vert^{2} \ket{0}\bra{0} + \alpha_{0} \alpha_{1}^{*} \ket{0}\bra{1} + \alpha_{0}^{*} \alpha_{1} \ket{1}\bra{0} + \vert \alpha_{1} \vert^{2} \ket{1}\bra{1}.
	\end{equation*}
	With these calculations in hand, if we write 
	\begin{equation*}
		\rho_{A}^{\textnormal{(out)}} = \eta \ket{\psi}_{A} \bra{\psi} + \frac{1-\eta}{2} \mathbf{1}_{A},
	\end{equation*}
	then we must have
	\begin{equation*} 
		\eta = \mu^{2} \qquad \text{and} \qquad \mu^{2} = 2\mu \nu.
	\end{equation*}
	From this last equality we have that $\mu = 0$ or $\mu = 2 \nu$. Substituting this equality into $\mu^{2} + 2\nu^{2} = 1$ yields $6\nu^{2} = 1$, whence $\nu^{2} = 1/6$. It follows that $\mu^{2} = 4\nu^{2} = 2/3$. 

\end{proof}

\subsection{Asymmetric Universal Cloning Machines}
Notice that in the definition of the cloning machine given above the symmetry of the outputs ($\rho_{A}^{\text{(out)}} = \rho_{B}^{\text{(out)}}$) is a consequence of the equality of the coefficients of the terms $\ket{i}_{A} \ket{j}_{B} \ket{j}_{X}$ and $\ket{j}_{A} \ket{i}_{B} \ket{j}_{X}$. To develop an asymmetric cloning machine, then, we give different contributions to these terms. In particular, we define
\begin{align*}
    \ket{0}_{A} \ket{O}_{B} \ket{\Sigma}_{X} &\to \mu \ket{0}_{A} \ket{0}_{B} \ket{0}_{X} + \nu \ket{0}_{A} \ket{1}_{B} \ket{1}_{X} + \xi \ket{1}_{A} \ket{0}_{B} \ket{0}_{X}\\
    \ket{1}_{A} \ket{O}_{B} \ket{\Sigma}_{X} &\to \mu \ket{1}_{A} \ket{1}_{B} \ket{1}_{X} + \nu \ket{1}_{A} \ket{0}_{B} \ket{0}_{X} + \xi \ket{0}_{A} \ket{1}_{B} \ket{0}_{X}.
\end{align*}

If a state in the form $\ket{\psi} = \alpha_{0} \ket{0} + \alpha_{1} \ket{1}$ is given as the input this machine, then the state of the output copy $A$ is
\begin{equation}
\label{Aclone}
    \rho_{A}^{\text{(out)}} = 2 \mu \nu \ket{\psi}_{A} \bra{\psi} + \xi^{2} \mathbf{1}_{A} + (\mu^{2} + \nu^{2} - \xi^{2} - 2\mu \nu)\Big ( \vert \alpha_{0} \vert^{2} \ket{0} \bra{0} + \vert \alpha_{1} \vert^{2} \ket{1} \bra{1} \Big ),
\end{equation}
with the corresponding  output in $B$ is
\begin{equation}
\label{Bclone}
    \rho_{B}^{\text{(out)}} = 2 \mu \xi \ket{\psi}_{A} \bra{\psi} + \nu^{2} \mathbf{1}_{A} + (\mu^{2} + \xi^{2} - \nu^{2} - 2\mu \xi)\Big ( \vert \alpha_{0} \vert^{2} \ket{0} \bra{0} + \vert \alpha_{1} \vert^{2} \ket{1} \bra{1} \Big ).
\end{equation}
Observe that $\rho_{A}^{\text{(out)}}$ and $\rho_{B}^{\text{(out)}}$ are similar; the $B$-case is obtained from the $A$-case by swapping the roles of $\nu$ and $\xi$.

\begin{proof}[Detailed Calculations]
The calculations here are very similar to those from Section 1.1. 
\end{proof}

Notice that the last terms in \eqref{Aclone} and \eqref{Bclone} are state-dependent. By imposing the requirement that the cloner be independent of the input state we require
\begin{align*}
    \mu^{2} + \nu^{2} - \xi^{2} - 2\mu \nu &= 0\\
    \mu^{2} + \xi^{2} - \nu^{2} - 2\mu \xi &= 0.
\end{align*}
Adding these equations yields
\begin{equation*}
    \mu^{2} - \mu \xi - \mu \nu = 0
\end{equation*}
from which we conclude that $\mu = \nu + \xi$. Since we require the output of the cloner to be normalized, we require that
\begin{equation}
\label{normalization}
    \mu^{2} + \nu^{2} + \xi^{2} = 1
\end{equation}
Also from \eqref{Aclone} we find that
\begin{equation*}
    \eta_{A} = 2\mu \nu \quad \text{and}  \quad \frac{1 - \eta_{A}}{2} = \xi^{2},
\end{equation*}
while from \eqref{Bclone} we see that
\begin{equation*}
    \eta_{B} = 2 \mu \xi, \quad \text{and} \quad \frac{1 - \eta_{B}}{2} = \nu^{2}.
\end{equation*}
Recalling that the fidelity, $F$, is related to the shrinking factor $\eta$ by $\eta = 2F - 1$, we see that these calculations yield fidelities for the $A$ and $B$ copies:
\begin{align*} 
    F_{A} &= \frac{1}{2} (2 \mu \nu + 1) = 1 - \xi^{2}\\
    F_{B} &= \frac{1}{2} (2 \mu \xi + 1) = 1 - \nu^{2}.
\end{align*}

\subsection{Asymmetric Phase-Covariant Cloning Machine}
Consider an input state of the form
\begin{equation*}
    \ket{\psi} = \frac{1}{\sqrt{2}} \Big ( \ket{0} + e^{i\phi} \ket{1} \Big ).
\end{equation*}
In this case we find that the final term in \eqref{Aclone} and \eqref{Bclone} is 
\begin{align*}
    \left \vert \frac{1}{\sqrt{2}} \right \vert^{2} \ket{0} \bra{0} + \left \vert \frac{e^{i\phi}}{\sqrt{2}} \right \vert^{2} \ket{1} \bra{1} = \frac{1}{2} \Big ( \ket{0} \bra{0} + \ket{1} \bra{1} \Big ) = \frac{1}{2} \mathbf{1},
\end{align*}
meaning that the last term is no longer dependent on the input state. In particular we find that the outputs reduce to
\begin{equation}
\label{PCAclone}
    \rho_{A}^{\text{(out)}} = 2 \mu \nu \ket{\psi}_{A} \bra{\psi} + \left ( \xi^{2} + \frac{\mu^{2} + \nu^{2} - \xi^{2} - 2\mu \nu}{2} \right )  \mathbf{1}_{A} 
\end{equation}
and
\begin{equation}
\label{PCBclone}
    \rho_{B}^{\text{(out)}} = 2 \mu \xi \ket{\psi}_{A} \bra{\psi} + \left ( \nu^{2} + \frac{\mu^{2} + \xi^{2} - \nu^{2} - 2\mu \xi}{2} \right ) \mathbf{1}_{B}.
\end{equation}
We are thus lead to the following formulas for the shrinking factors:
\begin{align}
    \eta_{A} = 2 \mu \nu = 2\nu \sqrt{1 - (\nu^{2} + \xi^{2})} \label{Ashrink}\\
    \eta_{B} = 2 \mu \xi = 2 \xi \sqrt{1 - (\nu^{2} + \xi^{2})} \label{Bshrink}.
\end{align}
This cloning machine is optimal if, whenever we fix the quality of one of the clones, say $A$, the quality of the other clone is as high as possible. Since the quality of the clone $A$ can be expressed in terms of $\eta_{A}, \eta_{B}$, we focus on the trade-off in the shrinking factors. For a fixed value of $\eta_{A}$ we solve \eqref{Ashrink} for $\xi$ in terms of $\nu$ and insert this into \eqref{Bshrink} to see that
\begin{equation}
	\label{etaB_optimal}
    \eta_{B}(\nu) = \frac{\eta_{A}}{\nu} \sqrt{1 - \nu^{2} - \frac{\eta_{A}^{2}}{4 \nu^{2}}}.
\end{equation}
Thus given a value of $\eta_{A}$ we can determine a value of $\nu$ that maximizes the value of $\eta_{B}.$ We note that the domain of $\eta_{B}$ has two components:
\begin{align*}
	 \textnormal{Domain} \ \eta_{B} &= \left [ -\sqrt{\frac{1}{2} + \frac{1}{2} \sqrt{1 - \eta_{A}^{2}}}, -\sqrt{\frac{1}{2} - \frac{1}{2} \sqrt{1 - \eta_{A}^{2}}} \right ] \\ 
	 \qquad & \bigcup \left [ \sqrt{\frac{1}{2} - \frac{1}{2} \sqrt{1 - \eta_{A}^{2}}}, \sqrt{\frac{1}{2} + \frac{1}{2} \sqrt{1 - \eta_{A}^{2}}} \right ].
\end{align*}
Since we expect the scaling coefficient $\eta_{B}$ to be nonnegative, we seek a solution from the positive component of the domain. That is, we require
\begin{equation*}
	\nu \in \left [ \sqrt{\frac{1}{2} - \frac{1}{2} \sqrt{1 - \eta_{A}^{2}}}, \sqrt{\frac{1}{2} + \frac{1}{2} \sqrt{1 - \eta_{A}^{2}}} \right ].
\end{equation*}
%{\color{red}{In general dimesions there is no formula for the corresponding value of $\nu$, but in dimension $2$ there might be a formula. Right now I have reduced this to the following equation for $\nu$:
%\begin{equation*}
%    4 \nu^{5} - 4 \nu^{4} + 4 \nu^{2} - 3 \eta^{2} = 0.
%\end{equation*}
%Can we show that there is a unique value of $\nu$ that corresponds to the maximum?
%}}

\subsection{Optimization} We seek to optimize the value of $\eta_{B}$ given $\eta_{A}$. Since the fidelity of a clone is given by $F = (1 + \eta)/2$, this amounts to optimizing the fidelity of the $B$-clone once the fidelity of the $A$-clone has been set. Recalling that $\eta_{A} = 2 \mu \nu$ and $\eta_{B} = 2 \mu \xi$ with $\mu^{2} + \nu^{2} + \xi^{2} = 1$, we notice that one approach is to consider this as a constrained optimization problem to which we apply the method of Lagrange multipliers. As such we seek values of $\mu, \nu, \xi, \lambda_{1}, \lambda_{2}$ so that
\begin{equation} 
	\label{lagrange1}
\begin{aligned}
	\nabla \eta_{B} &= \lambda_{1} \nabla g_{1} + \lambda_{2} \nabla g_{2},\\
	g_{1} &= 0,\\
	g_{2} &= 0,
\end{aligned}
\end{equation}
where
\begin{equation*}
	g_{1}(\mu, \nu, \xi) = 2 \mu \nu - \eta_{A} \quad \text{and} \quad g_{2}(\mu, \nu, \xi) = \mu^{2} + \nu^{2} + \xi^{2} - 1.
\end{equation*}
The equations \eqref{lagrange1} yield the following system of (nonlinear) equations:
\begin{align}
	\xi &= \lambda_{1} \nu + \lambda_{2} \mu \label{lagrangesys1}\\
	0 &= \lambda_{1} \mu + \lambda_{2} \nu \label{lagrangesys2}\\
	\mu &= \lambda_{2} \xi \label{lagrangesys3}\\
	2 \mu \nu &= \eta_{A} \label{lagrangesys4}\\
	1 &= \mu_{2} + \nu^{2} + \xi^{2}. \label{lagrangesys5} 
\end{align}
We view equations \eqref{lagrangesys1} and \eqref{lagrangesys2} as a linear system of equations in $\mu$ and $\nu$ (viewing $\lambda_{1}$ and $\lambda_{2}$ as coefficients), the solution of which is given by
\begin{equation}
	\mu = \frac{\lambda_{2}}{\lambda_{2}^{2} - \lambda_{1}^{2}} \xi \quad \text{and} \quad \nu = - \frac{\lambda_{1}}{\lambda_{2}^{2} - \lambda_{1}^{2}} \xi.
\end{equation}
In light of equation \eqref{lagrangesys3} together with the solution to \eqref{lagrangesys1} and \eqref{lagrangesys2} we find that
\begin{equation*}
	\lambda_{2}^{2} - \lambda_{1}^{2} = 1,
\end{equation*}
meaning that
\begin{equation*}
	\mu = \lambda_{2} \xi \quad \text{and} \quad \nu = - \lambda_{1} \xi.
\end{equation*}
These facts can now be inserted into \eqref{lagrangesys5} to yield
\begin{equation*}
	\xi^{2}(\lambda_{2}^{2} + \lambda_{1}^{2} + 1) = 1.
\end{equation*}
The fact that $\xi_{2}^{2} - \xi_{1}^{2} = 1$ allows us to simplify this to read
\begin{equation*}
	2 \lambda_{2}^{2} \xi^{2} = 1.
\end{equation*}
Once again we use equation \eqref{lagrangesys3} to see that
\begin{equation*}
	2 \mu^{2} = 1,
\end{equation*}
whence $\mu = \pm \sqrt{2}/2$. We now use \eqref{lagrangesys4} to find that
\begin{equation*}
	\nu = \pm \frac{\eta_{A}}{\sqrt{2}}.
\end{equation*}
Returning our formulas for $\mu, \nu$ to equation \eqref{lagrangesys5} yields
\begin{equation*}
	\xi = \pm \sqrt{\frac{1 - \eta_{A}^{2}}{2}}.
\end{equation*}
It follows that the optimal value of $\eta_{B}$ is given by
\begin{equation*}
	\eta_{B} = 2 \left ( \frac{\sqrt{2}}{2}\right )\sqrt{\frac{1 - \eta_{A}^{2}}{2}} = \sqrt{1 - \eta_{A}^{2}}.
\end{equation*}
This yields the circle relation
\begin{equation*}
\eta_{A}^{2} + \eta_{B}^{2} = 1,
\end{equation*}
which agrees with the optimization result in \cite{REZAKHANI2005278}. 

We point out that in the symmetric case in which $\eta_{A} = \eta_{B}$ we have $\eta_{A} = 1/\sqrt{2}$ which yields the optimal fidelity
\begin{equation*}
	F = \frac{1}{2}\left ( 1 + \frac{1}{\sqrt{2}} \right ) = \frac{1}{2} + \frac{1}{\sqrt{8}},
\end{equation*}
in agreement with \cite{PhysRevA.65.012304}.



\section{Implementation}

The following circuit is drawn from \cite{PhysRevA.56.3446}. We write $\vert \psi \rangle_{a_{1}}^{(\textnormal{in})}$ for the qubit we are trying to clone. The circuit below aims to produce two copies of the input qubit. In their initial state we write $\vert 0 \rangle_{a_{2}}, \vert 0 \rangle_{a_{3}}$ for these qubits. The first part of the circuit prepares the target qubits ($a_{2}$ and $a_{3}$) in a state which is useful for the cloning operation. The second component of the circuit (which involves $\vert \psi \rangle_{a_{1}}^{(\textnormal{in})}$) is the piece of the circuit that handles the actual copying.

\begin{center}
\begin{quantikz}
\lstick{$\ket{\psi}_{a_{1}}^{\text{(in)}}$} & \qw & \qw & \qw & \qw & \qw & \ctrl{1} & \ctrl{2} & \targ & \qw & \targ & \qw & \qw \rstick[wires = 3]{$\ket{\psi}_{a_{1} a_{2} a_{3}}^{\text{(out)}}$}\\
\lstick{$\ket{0}_{a_{2}}$} & \gate{R} & \ctrl{1} & \qw &\targ & \qw  & \gate{R} & \targ & \qw & \qw & \ctrl{-1} & \qw & \qw \\
\lstick{$\ket{0}_{a_{3}}$} & \qw & \targ & \qw & \gate{R} & \ctrl{-1} & \qw & \qw & \targ & \qw & \qw & \ctrl{-2} & \qw \\
\end{quantikz}
\end{center}

Here the gate $R = R(\theta)$ is a rotation gate defined by
\begin{align*}
    R\ket{0} &= \cos(\theta) \ket{0} + \sin(\theta) \ket{1}\\
    R\ket{1} &= -\sin(\theta) \ket{0} + \cos(\theta) \ket{0}.
\end{align*}
The first part of this circuit involves only the $a_{2}$ and $a_{3}$ qubits; this is a preparation component of the circuit. The output of this portion of the circuit is of the form
\begin{equation*}
    \ket{\psi}_{a_{2} a_{3}}^{\textnormal{(out)}} = C_{1} \ket{0}_{a_{2}} \ket{0}_{a_{3}} + C_{2} \ket{0}_{a_{2}} \ket{1}_{a_{3}} + C_{3} \ket{1}_{a_{2}} \ket{0}_{a_{3}} + C_{4} \ket{1}_{a_{2}} \ket{1}_{a_{3}}.
\end{equation*}
Following the circuit above we find that the coefficients $C_{j}, j=1,2,3,4$ are given by
\begin{align*}
    C_{1} &= \cos(\theta_{1}) \cos(\theta_{2}) \cos(\theta_{3}) + \sin(\theta_{1}) \sin(\theta_{2}) \sin(\theta_{3})\\
    C_{2} &= \sin(\theta_{1}) \cos(\theta_{2}) \cos(\theta_{3}) - \cos(\theta_{1}) \sin(\theta_{2}) \sin(\theta_{3})\\
    C_{3} &= \cos(\theta_{1}) \cos(\theta_{2}) \sin(\theta_{3}) - \sin(\theta_{1}) \sin(\theta_{2}) \cos(\theta_{3})\\
    C_{4} &= \cos(\theta_{1}) \sin(\theta_{2}) \sin(\theta_{3}) + \sin(\theta_{1}) \cos(\theta_{2}) \cos(\theta_{3}).
\end{align*}

Consider an input $\ket{\psi} = \alpha_{0} \ket{0} + \alpha_{1} \ket{1}$. The output from the circuit above is
\begin{align*}
    \ket{\psi}^{(out)} &= \alpha_{0} C_{1} \ket{000} + \alpha_{0} C_{2} \ket{101} + \alpha_{0} C_{3} \ket{110} + \alpha_{0} C_{4} \ket{011} \\
    & \quad + \alpha_{1} C_{1} \ket{111} + \alpha_{1} C_{2} \ket{010} + \alpha_{1} C_{3} \ket{001} + \alpha_{1} C_{4} \ket{100}.
\end{align*}
The output state of the cloning machine in the preceding section for this input is
\begin{align*}
    \ket{\psi}^{(out)} &= \alpha_{0} \mu \ket{000} + \alpha_{0} \nu \ket{011} + \alpha_{0} \xi \ket{101} \\
    & \quad + \alpha_{1} \mu \ket{111} + \alpha_{1} \nu \ket{100} + \alpha_{1} \xi \ket{101}.
\end{align*}
By comparing coefficients we see that we require
\begin{equation*}
    C_{1} = \mu, \ \ C_{2} = \xi, \ \ C_{3} = 0, \ \ C_{4} = \nu.
\end{equation*}
%{\color{red}{We can now write $\mu, \xi, \nu$ in terms of $\theta_{1}, \theta_{2}, \theta_{3}$. The condition that $C_{3} = 0$ seems like a pretty serious constraint. I'm not sure how to handle this term. In any case, I think we can now rewrite the $\eta_{A}, \eta_{B}$ expressions in terms of the $\theta_{j}$. Does this lend itself to the information vs disturbance question?}}

%{\color{red}{Actually I think this is no problem. The $C_{j}$ coefficients satisfy the normalization condition $C_{1}^{2} + C_{2}^{2} + C_{3}^{2} + C_{4}^{2} = 1$, so the fact that $C_{1} = \mu, C_{2} = \xi, C_{4} = \nu$ and the normalization condition \eqref{normalization} means that if we find $(\theta_{1}, \theta_{2}, \theta_{3})$ to satisfy $C_{1} = \mu$, etc., then $C_{3} = 0$ automatically.}}

This means that, in the notation of \cite{REZAKHANI2005278}, we have
\begin{align*}
	\mu  &= \cos(\theta_{1}) \cos(\theta_{2}) \cos(\theta_{3}) + \sin(\theta_{1}) \sin(\theta_{2}) \sin(\theta_{3})\\
	\xi &= \sin(\theta_{1}) \cos(\theta_{2}) \cos(\theta_{3}) - \cos(\theta_{1}) \sin(\theta_{2}) \sin(\theta_{3})\\
	\nu &= \cos(\theta_{1}) \sin(\theta_{2}) \sin(\theta_{3}) + \sin(\theta_{1}) \cos(\theta_{2}) \cos(\theta_{3}),
\end{align*}
together with the restriction that
\begin{equation*}
	\cos(\theta_{1}) \cos(\theta_{2}) \sin(\theta_{3}) - \sin(\theta_{1}) \sin(\theta_{2}) \cos(\theta_{3}) = 0.
\end{equation*}
Observe that since the coefficients $\mu, \xi, \nu$ satisfy the normalization condition \eqref{normalization}, this restriction is automatic. Nonetheless, we can rewrite this restriction as
\begin{equation}
	\label{theta3formula}
	\tan(\theta_{3}) = \tan(\theta_{1}) \tan(\theta_{2}),
\end{equation}
meaning that once $\theta_{1}$ and $\theta_{2}$ are chosen, the value of $\theta_{3}$ can be determined. In fact, we can use this formula to reduce the equations above to involve only $\theta_{1}$ and $\theta_{2}$. From \eqref{theta3formula} we find that
\begin{equation*}
	\theta_{3} = \arctan \Big ( \tan(\theta_{1}) \tan(\theta_{2}) \Big ),
\end{equation*}
from which one calculates
\begin{equation*}
	\cos(\theta_{3}) = \frac{1}{\sqrt{1 + \tan^{2}(\theta_{1}) \tan^{2}(\theta_{2})}} \quad \text{and} \quad \sin(\theta_{3}) = \frac{\tan(\theta_{1}) \tan(\theta_{2})}{\sqrt{1 + \tan^{2}(\theta_{1}) \tan^{2}(\theta_{2})}}
\end{equation*}
We now find that
\begin{align*}
	\mu(\theta_{1}, \theta_{2}) &= \frac{\cos(\theta_{1}) \cos(\theta_{2}) + \sin(\theta_{1}) \sin(\theta_{2}) \tan(\theta_{1}) \tan(\theta_{2})}{\sqrt{1 + \tan^{2}(\theta_{1}) \tan^{2}(\theta_{2})}}\\
	\xi(\theta_{1}, \theta_{2}) &= \frac{\sin(\theta_{1}) \cos(\theta_{2}) - \sin(\theta_{1}) \sin(\theta_{2}) \tan(\theta_{2})}{\sqrt{1 + \tan^{2}(\theta_{1}) \tan^{2}(\theta_{2})}}\\
	\nu(\theta_{1}, \theta_{2}) &= \frac{\sin(\theta_{1}) \sin(\theta_{2}) \tan(\theta_{2}) + \sin(\theta_{1}) \cos(\theta_{2})}{\sqrt{1 + \tan^{2}(\theta_{1}) \tan^{2}(\theta_{2})}}.
\end{align*}
These formulas for the coefficients of the cloner in terms of the circuit angles can be further simplified:
\begin{align*}
	\mu(\theta_{1}, \theta_{2}) &= \cos(\theta_{1}) \cos(\theta_{2}) \left ( \frac{1 + \tan^{2}(\theta_{1}) \tan^{2}(\theta_{2})}{\sqrt{1 + \tan^{2}(\theta_{1}) \tan^{2}(\theta_{2})}} \right )\\
	&= \cos(\theta_{1}) \cos(\theta_{2}) \sqrt{1 + \tan^{2}(\theta_{1}) \tan^{2}(\theta_{2})};\\
	\xi(\theta_{1}, \theta_{2}) &= \sin(\theta_{1}) \cos(\theta_{2}) \left ( \frac{1 - \tan^{2}(\theta_{2})}{\sqrt{1 + \tan^{2}(\theta_{1}) \tan^{2}(\theta_{2})}}\right );\\
	\nu(\theta_{1}, \theta_{2}) &= \frac{\sin(\theta_{1}) \cos(\theta_{2}) ( \tan^{2}(\theta_{2}) + 1)}{\sqrt{1 + \tan^{2}(\theta_{1}) \tan^{2}(\theta)}}\\
	&= \frac{\sin(\theta_{1}) \cos(\theta_{2}) \sec^{2}(\theta_{2})}{\sqrt{1 + \tan^{2}(\theta_{1}) \tan^{2}(\theta_{2})}}\\
	&= \frac{\sin(\theta_{1})}{\cos(\theta_{2}) \sqrt{1 + \tan^{2}(\theta_{1}) \tan^{2}(\theta_{2})}}.
\end{align*}

The values of the factors $\eta_{A}$ and $\eta_{B}$ can now be rewritten in terms of $\theta_{1}$ and $\theta_{2}$. The simplified formulas provided above yield particularly convenient formulas:
\begin{align*}
	\eta_{A}(\theta_{1}, \theta_{2}) &= 2 \sin(\theta_{1}) \cos(\theta_{1}) = \sin(2 \theta_{1})\\
	\intertext{and}
	\eta_{B}(\theta_{1}, \theta_{2}) &= 2 \sin(\theta_{1}) \cos(\theta_{1}) \cos^{2}(\theta_{2}) \Big ( 1 - \tan^{2}(\theta_{2}) \Big )\\
	&= \sin(2 \theta_{1}) \cos(2 \theta_{2}).
\end{align*}
Of significance here is the fact that $\eta_{A}$ is independent of $\theta_{1}$. Note that the problem of choosing an optimal cloning scenario was spelled out at the end of the last section. Once one selects $\theta_{1}$ the value of $\eta_{A}$ is determined. The optimal cloning problem amounts to selecting a value of $\theta_{2}$ so that
\begin{equation*}
	\eta_{B} = \frac{\eta_{A}}{\nu} \sqrt{ 1 - \nu^{2} - \frac{\eta_{A}^{2}}{4 \nu^{2}}}
\end{equation*}
is maximized. This can now be rewritten as an optimization problem in the variable $\theta_{2}$.


\subsubsection{Fidelity}
It is common to evaluate the quality of the clones using the measure of fidelity, defined by
\begin{equation*}
	F_{A} = \bra{\psi} \rho_{A}^{\textnormal{(out)}} \ket{\psi} \qquad \text{and} \qquad F_{B} = \bra{\psi} \rho_{B}^{\textnormal{(out)}} \ket{\psi},
\end{equation*}
where $\ket{\psi}$ is the input state that we were attempting to clone. Having written
\begin{equation*}
	\rho_{A}^{\textnormal{(out)}} = \eta_{A} \bra{\psi} \ket{\psi} + \frac{1 - \eta_{A}}{2} \mathbf{1}, \quad \text{and} \quad
	\rho_{B}^{\textnormal{(out)}} = \eta_{B} \bra{\psi} \ket{\psi} + \frac{1 - \eta_{B}}{2} \mathbf{1}
\end{equation*}
the fidelities are given by
\begin{equation*}
	F_{A} = \frac{1}{2}(1 + \eta_{A}) \qquad \text{and} \qquad F_{B} = \frac{1}{2}(1 + \eta_{B}).
\end{equation*}
In particular, with the aid of the formulas for $\eta_{A}$ and $\eta_{B}$ developed above we see that
\begin{equation*}
	F_{A}(\theta_{1}, \theta_{2}) = \frac{1}{2} \Big (1 + \sin(2\theta_{1}) \Big ) \quad \text{and} \quad
	F_{B}(\theta_{1}, \theta_{2}) = \frac{1}{2} \Big ( 1 + \sin(2\theta_{1}) \cos(\theta_{2}) \Big ).
\end{equation*}
Note that these calculations do not reflect the relationship that exists between $\eta_{A}$ and $\eta_{B}$ that are a reflection of the normalization feature of the coefficients \eqref{normalization}. The optimal cloning situation is determined by selecting a value of $\theta_{1}$ and then determining the value of $\theta_{2}$ that optimizes $\eta_{B}$ as in \eqref{etaB_optimal}. Indeed if we write
\begin{equation*}
	\eta_{B}^{\textnormal{opt}} = \max_{\theta_{2}} \left [ \frac{\eta_{A}(\theta_{1},\theta_{2})}{\nu(\theta_{1}, \theta_{2})} \sqrt{1 - \nu^{2}(\theta_{1},\theta_{2}) - \frac{\eta_{A}^{2}(\theta_{1},\theta_{2})}{4 \nu^{2}(\theta_{1}, \theta_{2})}}\right ]
\end{equation*}
then the optimal cloning situation has the fidelities
\begin{equation*}
	F_{A} = \frac{1}{2}(1 + \sin(2 \theta_{1})) \qquad \text{and} \qquad F_{B} = \frac{1}{2} (1 + \eta_{B}^{\textnormal{opt}}).
\end{equation*}
Note that by having optimized over $\theta_{2}$ to obtain $\eta_{B}^{\textnormal{opt}}$, these fidelities depend only on $\theta_{1}$.

To determine the angle $\theta_{2}$ that yields the optimal fidelity in the $B$-clone we use the optimization arguments introduced earlier. The shrinking coefficients satisfy
\begin{equation*}
	\eta_{A}^{2} + \eta_{B}^{2} = 1.
\end{equation*}
Since $\eta_{A} = \sin(2 \theta_{1})$ and $\eta_{B} = \sin(2\theta_{1}) \cos(2 \theta_{2})$ we find that we achieve the optimal fidelity for the $B$-clone provided
\begin{equation*}
	\theta_{2} = \frac{1}{2} \arccos(\cot(2\theta_{1})).
\end{equation*}
This formula imposes some restrictions on the values of $\theta_{1}$. First we note that we require $\theta_{1} \neq n\pi$ for any $n \in \Z$ in order to remain in the domain of the cotangent function. In order to satisfy the domain requirements for the inverse cosine function we further require that 
\begin{equation*}
	\frac{\pi}{8} \leq \theta_{1} \leq \frac{3\pi}{8}.
\end{equation*}



%{\color{red}{I believe these formulas can now be used to calculate the information gain and the disturbance generated by Eve (who would keep one of the copies, say the $B$ copy) in terms of $\theta_{1}, \theta_{2}$, and $\theta_{3}$.}}


\subsection{Circuit Output} 
The output of the circuit depicted above with input $\ket{\psi}^{\textnormal{(in)}}_{a_{1}}  = \alpha_{0} \ket{0} + \alpha_{1} \ket{1}$ is
\begin{align*}
	\ket{\psi}^{\textnormal{(out)}}_{a_{1}a_{2}a_{3}} = &\alpha_{0} \Big ( C_{1} \ket{000} + C_{2} \ket{101} + C_{3} \ket{110} + C_{4} \ket{011}  \Big ) \\
	 + & \alpha_{1} \Big ( C_{1} \ket{111} + C_{2} \ket{010} + C_{3} \ket{001} + C_{4} \ket{100} \Big ). 
\end{align*}
Calculations similar to those developed in Section 1.1 yield the following reduced density operators (in the $a_{1}$ and $a_{2}$ qubits):
\begin{align*}
	\rho_{a_{1}}^{\textnormal{(our)}} = &\Big ( \vert \alpha_{0} \vert^{2} (C_{1}^{2} + C_{4}^{2}) + \vert \alpha_{1} \vert^{2} (C_{2}^{2} + C_{3}^{2})\Big ) \ket{0}\bra{0} \\
	+ & \Big ( 2 \alpha_{0} \alpha_{1}^{*} C_{1}C_{4} + 2 \alpha_{0}^{*} \alpha_{1} C_{2} C_{3} \Big ) \ket{0}\bra{1}\\
	+ & \Big ( 2 \alpha_{0} \alpha_{1}^{*} C_{2} C_{3} + 2 \alpha_{0}^{*} \alpha_{1} C_{1} C_{4} \Big ) \ket{1}\bra{0}\\
	+ & \Big ( \vert \alpha_{0} \vert^{2} (C_{2}^{2} + C_{3}^{2}) + \vert \alpha_{1} \vert^{2} (C_{1}^{2} + C_{4}^{2}) \Big ) \ket{1}\bra{1},\\
	\intertext{and}
	\rho_{a_{2}}^{\textnormal{(out)}} = &\Big ( \vert \alpha_{0} \vert^{2} (C_{1}^{2} + C_{2}^{2}) + \vert \alpha_{1}^{2} (C_{3}^{2} + C_{4}^{2}) \Big ) \ket{0}\bra{0} \\
	+ & \Big ( 2 \alpha_{0} \alpha_{1}^{*} C_{1} C_{2} + 2 \alpha_{0}^{*} \alpha_{1} C_{3} C_{4} \Big ) \ket{0}\bra{1}\\
	+ & \Big ( 2 \alpha_{0} \alpha_{1}^{*} C_{3} C_{4} + 2 \alpha_{0}^{*} \alpha_{1} C_{1} C_{2} \Big ) \ket{1}\bra{0}\\
	+ & \Big ( \vert \alpha_{0} \vert^{2} (C_{3}^{2} + C_{4}^{2}) + \vert \alpha_{1} \vert^{2} ( C_{1}^{2} + C_{2}^{2}) \Big ) \ket{1}\bra{1}.\\
\end{align*}



%\section{Information and Disturbance}



\bibliographystyle{plain}
\bibliography{reflist}

\end{document}
